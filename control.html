<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Anjali тАУ Universal Exam Control Panel</title>

<style>
body{margin:0;font-family:system-ui;background:#f5f6fa}
header{background:#8b2d2d;color:#fff;padding:14px;text-align:center;font-size:20px}
#layout{display:flex;height:calc(100vh - 60px)}
#tree{width:340px;background:#fff;border-right:1px solid #ddd;overflow:auto;padding:10px}
#panel{flex:1;padding:10px;overflow:auto}

.subject{font-weight:bold;color:#8b2d2d;margin-top:8px;cursor:pointer}
.topic{margin-left:14px;padding:6px;border-radius:6px;cursor:pointer}
.topic:hover{background:#eee}
.topic.active{background:#8b2d2d;color:white}

textarea,input{width:100%;padding:8px;margin:6px 0}
button{padding:8px 14px;margin:4px;border:none;border-radius:8px;background:#8b2d2d;color:white}
.secondary{background:#555}

.box{border:1px dashed #aaa;padding:10px;margin-top:10px;border-radius:8px;background:#fff}
.viewBox{min-height:300px;max-height:400px;overflow:auto;border:1px solid #ccc;padding:10px;background:#fafafa}
</style>
</head>

<body>
<header>ЁЯУЪ Anjali тАУ Universal Exam Control Panel</header>

<div id="layout">
<div id="tree"></div>

<div id="panel">
<h3 id="path">рдХреЛрдИ рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ</h3>

<!-- ARTICLE -->
<div class="box">
<b>ЁЯУД Article</b>
<textarea id="article" style="min-height:150px" placeholder="рдпрд╣рд╛рдБ рд▓реЗрдЦ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВтАж"></textarea>
<button onclick="generateOneLiners()">ЁЯФ╣ One-Liner рдмрдирд╛рдП</button>
<button onclick="generateFromArticle()">тЪб Exam MCQ рдмрдирд╛рдП</button>
</div>

<!-- ONE LINERS -->
<div class="box">
<b>ЁЯза One-Liners (рд╕рд╣реЗрдЬреЗ рдирд╣реАрдВ рдорд┐рдЯреЗрдВрдЧреЗ)</b>
<div id="oneLinerView" class="viewBox"></div>
<button onclick="saveOneLiners()">ЁЯТ╛ One-Liners Save</button>
</div>

<!-- MANUAL MCQ -->
<div class="box">
<b>ЁЯУЭ рдПрдХ MCQ рдЬреЛрдбрд╝реЗрдВ</b>
<textarea id="q"></textarea>
<input id="a" placeholder="A">
<input id="b" placeholder="B">
<input id="c" placeholder="C">
<input id="d" placeholder="D">
<input id="correct" placeholder="Correct (A/B/C/D)">
<textarea id="exp" placeholder="рд╡реНрдпрд╛рдЦреНрдпрд╛"></textarea>
<button onclick="saveOne()">Save</button>
<button class="secondary" onclick="deleteLast()">Delete Last</button>
</div>

<!-- BULK -->
<div class="box">
<b>ЁЯУЪ Bulk (рдкреНрд░рд╢реНрди тЖТ рдЙрддреНрддрд░ тЖТ рд╡реНрдпрд╛рдЦреНрдпрд╛)</b>
<textarea id="bulk" style="min-height:120px" placeholder="рдкреНрд░рд╢реНрди
рдЙрддреНрддрд░
рд╡реНрдпрд╛рдЦреНрдпрд╛

рдкреНрд░рд╢реНрди
рдЙрддреНрддрд░
рд╡реНрдпрд╛рдЦреНрдпрд╛"></textarea>
<button onclick="saveBulk()">Save Bulk</button>
</div>

<div class="box">
<button onclick="show()">ЁЯУВ рд╕рднреА рдкреНрд░рд╢реНрди рджреЗрдЦреЗрдВ</button>
<button onclick="speak()">ЁЯОЩя╕П рдЕрдВрдЬрд▓реА</button>
</div>

<div id="view" class="viewBox"></div>
</div>
</div>

<script>
/* ===== SYLLABUS ===== */
const AtoZ="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
const SYLLABUS={
"UP Police Constable":{
 "General Knowledge":{"A. History":[], "B. Geography":[], "C. Polity":[], "D. Economy":[], "E. Science":[], "F. Current Affairs":[]},
 "General Hindi":Object.fromEntries(AtoZ.map(x=>[x+". рд╡рд┐рд╖рдп",[]])),
 "Numerical & Mental Ability":Object.fromEntries(AtoZ.map(x=>[x+". рд╡рд┐рд╖рдп",[]])),
 "Mental Aptitude / Reasoning":Object.fromEntries(AtoZ.map(x=>[x+". рд╡рд┐рд╖рдп",[]]))
}
};

let DB=JSON.parse(localStorage.getItem("anjaliDB"))||SYLLABUS;
function saveDB(){localStorage.setItem("anjaliDB",JSON.stringify(DB));}

/* ===== TREE ===== */
let currentExam=null,currentSubject=null,currentTopic=null;
const tree=document.getElementById("tree");

for(let exam in DB){
 let h=document.createElement("h3");h.textContent=exam;tree.appendChild(h);
 for(let subject in DB[exam]){
  let s=document.createElement("div");s.className="subject";s.textContent=subject;
  let list=document.createElement("div");
  for(let topic in DB[exam][subject]){
   let t=document.createElement("div");t.className="topic";t.textContent=topic;
   t.onclick=()=>{
    document.querySelectorAll(".topic").forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    currentExam=exam;currentSubject=subject;currentTopic=topic;
    path.innerText=exam+" тЖТ "+subject+" тЖТ "+topic;
    show(); showOneLiners();
   };
   list.appendChild(t);
  }
  s.onclick=()=>list.style.display=list.style.display=="block"?"none":"block";
  tree.appendChild(s);tree.appendChild(list);
 }
}

/* ===== MCQ SAVE ===== */
function saveOne(){
 if(!currentTopic)return alert("рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ");
 DB[currentExam][currentSubject][currentTopic].push({
  q:q.value.trim(),a:a.value.trim(),b:b.value.trim(),c:c.value.trim(),d:d.value.trim(),
  correct:correct.value.trim(),exp:exp.value.trim()
 });
 saveDB(); show();
}

function saveBulk(){
 if(!currentTopic)return alert("рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ");
 const lines=bulk.value.split("\n").map(x=>x.trim()).filter(x=>x!=="");
 for(let i=0;i<lines.length;i+=3){
  if(lines[i]&&lines[i+1]&&lines[i+2]){
   DB[currentExam][currentSubject][currentTopic].push({
    q:lines[i],a:lines[i+1],b:"",c:"",d:"",correct:"A",exp:lines[i+2]
   });
  }
 }
 saveDB(); show(); alert("Bulk Saved");
}

function deleteLast(){
 DB[currentExam][currentSubject][currentTopic].pop();
 saveDB(); show();
}

/* ===== VIEW ===== */
function show(){
 let arr=DB[currentExam][currentSubject][currentTopic];
 view.innerHTML=arr.map((q,i)=>`
 ${i+1}. ${q.q}<br>
 A) ${q.a}<br>B) ${q.b}<br>C) ${q.c}<br>D) ${q.d}<br>
 тЬФ ${q.correct}<br><i>${q.exp}</i><hr>`).join("");
}

/* ===== ONE LINER ===== */
let tempOneLiners=[];

function generateOneLiners(){
 if(!currentTopic)return alert("рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ");
 const text=article.value.trim();
 if(text.length<80)return alert("рд▓реЗрдЦ рдЫреЛрдЯрд╛ рд╣реИ");
 text.split(/[ред.\n]/).forEach(l=>{
  l=l.trim();
  if(l.length>25&&l.length<200) tempOneLiners.push(l);
 });
 showOneLiners();
}

function showOneLiners(){
 let saved=DB[currentExam][currentSubject][currentTopic].filter(q=>q.exp==="One-Liner").map(x=>x.q);
 let all=[...saved,...tempOneLiners];
 oneLinerView.innerHTML=all.map((l,i)=>`${i+1}. ${l}<hr>`).join("");
}

function saveOneLiners(){
 tempOneLiners.forEach(l=>{
  DB[currentExam][currentSubject][currentTopic].push({q:l,a:"",b:"",c:"",d:"",correct:"",exp:"One-Liner"});
 });
 saveDB(); tempOneLiners=[]; showOneLiners(); alert("One-Liners Saved");
}

/* ===== SIMPLE EXAM ENGINE ===== */
function generateFromArticle(){
 if(!currentTopic)return alert("рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ");
 const t=article.value;
 if(!t.includes("1991")&&!t.includes("RBI"))return alert("рд▓реЗрдЦ рд╕реЗ рддрдереНрдп рдирд╣реАрдВ рдорд┐рд▓реЗ");

 if(t.includes("1991")){
  DB[currentExam][currentSubject][currentTopic].push({
   q:"рднрд╛рд░рдд рдореЗрдВ рдЖрд░реНрдерд┐рдХ рдЙрджрд╛рд░реАрдХрд░рдг рдХрдм рд▓рд╛рдЧреВ рд╣реБрдЖ?",
   a:"1991",b:"1947",c:"2000",d:"2010",correct:"A",exp:"рдЙрджрд╛рд░реАрдХрд░рдг 1991 рдореЗрдВ рд▓рд╛рдЧреВ рд╣реБрдЖ"
  });
 }

 if(t.includes("RBI")){
  DB[currentExam][currentSubject][currentTopic].push({
   q:"рднрд╛рд░рдд рдХреА рдореМрджреНрд░рд┐рдХ рдиреАрддрд┐ рдХреМрди рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ?",
   a:"RBI",b:"рд╕рд░рдХрд╛рд░",c:"SEBI",d:"WTO",correct:"A",exp:"RBI рдореМрджреНрд░рд┐рдХ рдиреАрддрд┐ рдЪрд▓рд╛рддрд╛ рд╣реИ"
  });
 }

 saveDB(); show(); alert("Exam MCQ рдмрди рдЧрдП");
}

/* ===== VOICE ===== */
function speak(){
 let arr=DB[currentExam][currentSubject][currentTopic]; let i=0;
 function go(){
  if(i>=arr.length)return;
  let u=new SpeechSynthesisUtterance(arr[i].q);
  u.lang="hi-IN"; speechSynthesis.speak(u);
  i++;u.onend=()=>setTimeout(go,800);
 }
 go();
}
</script>
</body>
</html>
