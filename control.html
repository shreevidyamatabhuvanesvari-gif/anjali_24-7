<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Anjali тАУ Universal Exam Control Panel</title>

<style>
body{margin:0;font-family:system-ui;background:#f5f6fa}
header{background:#8b2d2d;color:#fff;padding:14px;text-align:center;font-size:20px}
#layout{display:flex;height:calc(100vh - 60px)}
#tree{width:340px;background:#fff;border-right:1px solid #ddd;overflow:auto;padding:10px}
#panel{flex:1;padding:10px;overflow:auto}

.subject{font-weight:bold;color:#8b2d2d;margin-top:8px;cursor:pointer}
.topic{margin-left:14px;padding:4px;border-radius:6px;cursor:pointer}
.topic:hover{background:#eee}
.topic.active{background:#8b2d2d;color:white}

textarea{width:100%;min-height:180px;padding:8px;margin:6px 0}
button{padding:6px 14px;margin:4px;border:none;border-radius:6px;background:#8b2d2d;color:white;cursor:pointer}
.secondary{background:#555}
.danger{background:#b00020}

.box{border:1px dashed #aaa;padding:10px;margin-top:10px;border-radius:8px;background:#fff}
.big{min-height:220px;overflow:auto}
.item{border-bottom:1px dashed #ccc;padding:6px 0}
</style>
</head>

<body>
<header>ЁЯУЪ Anjali тАУ Universal Exam Control Panel</header>

<div id="layout">
<div id="tree"></div>

<div id="panel">
<h3 id="path">рдХреЛрдИ рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ</h3>

<!-- ================= QUIZ ================= -->
<div class="box">
<b>ЁЯУШ Quiz Bank (Bulk MCQ)</b>
<textarea id="quizBox" placeholder="рдпрд╣рд╛рдБ рдХрдИ MCQ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВтАж"></textarea>
<button onclick="addQuiz()">тЮХ Question Bank рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ</button>
<button class="danger" onclick="deleteSelected('mcq')">ЁЯЧСя╕П рдЪреБрдиреЗ рд╣реБрдП Delete</button>
<div id="quizPreview" class="big"></div>
</div>

<!-- ================= ONE LINER ================= -->
<div class="box">
<b>ЁЯУМ One-Liner / Notes</b>
<textarea id="oneBox" placeholder="рд╣рд░ рд▓рд╛рдЗрди = рдПрдХ One-Liner"></textarea>
<button onclick="addOne()">тЮХ Question Bank рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ</button>
<button class="danger" onclick="deleteSelected('one-liner')">ЁЯЧСя╕П рдЪреБрдиреЗ рд╣реБрдП Delete</button>
<div id="onePreview" class="big"></div>
</div>

<!-- ================= COMBINED ================= -->
<div class="box">
<b>ЁЯУЪ Combined View</b>
<textarea id="combinedBox"></textarea>
<button onclick="addCombined()">тЮХ Question Bank рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ</button>
<button class="danger" onclick="deleteSelected('all')">ЁЯЧСя╕П рдЪреБрдиреЗ рд╣реБрдП Delete</button>
<div id="combinedPreview" class="big"></div>
</div>

<button class="secondary" onclick="openQuestionBank()">ЁЯУЪ Question Bank Manager</button>
</div>
</div>

<script>
/* ===== DATABASE ===== */
const AtoZ="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
const SYLLABUS={
"UP Police Constable":{
 "General Knowledge":{"A. History":[], "B. Geography":[], "C. Polity":[], "D. Economy":[], "E. Science":[], "F. Current Affairs":[]},
 "General Hindi":Object.fromEntries(AtoZ.map(x=>[x+". рд╡рд┐рд╖рдп",[]])),
 "Numerical & Mental Ability":Object.fromEntries(AtoZ.map(x=>[x+". рд╡рд┐рд╖рдп",[]])),
 "Mental Aptitude / Reasoning":Object.fromEntries(AtoZ.map(x=>[x+". рд╡рд┐рд╖рдп",[]]))
}
};

let DB=JSON.parse(localStorage.getItem("anjaliDB"))||SYLLABUS;
function saveDB(){localStorage.setItem("anjaliDB",JSON.stringify(DB));}

let currentExam=null,currentSubject=null,currentTopic=null;
const tree=document.getElementById("tree");

/* ===== TREE ===== */
for(let exam in DB){
 let h=document.createElement("h3");h.textContent=exam;tree.appendChild(h);
 for(let subject in DB[exam]){
  let s=document.createElement("div");s.className="subject";s.textContent=subject;
  let list=document.createElement("div");
  for(let topic in DB[exam][subject]){
   let t=document.createElement("div");t.className="topic";t.textContent=topic;
   t.onclick=()=>{
    document.querySelectorAll(".topic").forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    currentExam=exam;currentSubject=subject;currentTopic=topic;
    path.textContent=exam+" тЖТ "+subject+" тЖТ "+topic;
    render();
   };
   list.appendChild(t);
  }
  s.onclick=()=>list.style.display=list.style.display=="block"?"none":"block";
  tree.appendChild(s);tree.appendChild(list);
 }
}

/* ===== ADD ===== */
function addQuiz(){
 quizBox.value.split("\n\n").forEach(q=>{
  if(q.trim()) DB[currentExam][currentSubject][currentTopic].push({type:"mcq",q:q.trim()});
 });
 quizBox.value=""; saveDB(); render();
}

function addOne(){
 oneBox.value.split("\n").forEach(l=>{
  if(l.trim()) DB[currentExam][currentSubject][currentTopic].push({type:"one-liner",q:l.trim()});
 });
 oneBox.value=""; saveDB(); render();
}

function addCombined(){
 combinedBox.value.split("\n\n").forEach(x=>{
  DB[currentExam][currentSubject][currentTopic].push({
   type: x.length>120?"mcq":"one-liner",
   q:x.trim()
  });
 });
 combinedBox.value=""; saveDB(); render();
}

/* ===== DELETE SELECTED ===== */
function deleteSelected(mode){
 let arr=DB[currentExam][currentSubject][currentTopic];
 DB[currentExam][currentSubject][currentTopic]=arr.filter((x,i)=>{
  let cb=document.getElementById("cb_"+i);
  if(!cb) return true;
  if(!cb.checked) return true;
  if(mode==="all") return false;
  return x.type!==mode;
 });
 saveDB(); render();
}

/* ===== RENDER ===== */
function render(){
 let arr=DB[currentExam][currentSubject][currentTopic];
 quizPreview.innerHTML=arr.map((x,i)=>x.type==="mcq"?`
 <div class="item">
 <input type="checkbox" id="cb_${i}"> ${x.q}
 </div>`:"").join("");
 onePreview.innerHTML=arr.map((x,i)=>x.type==="one-liner"?`
 <div class="item">
 <input type="checkbox" id="cb_${i}"> ${x.q}
 </div>`:"").join("");
 combinedPreview.innerHTML=arr.map((x,i)=>`
 <div class="item">
 <input type="checkbox" id="cb_${i}"> ${x.q}
 </div>`).join("");
}

function openQuestionBank(){
 location.href="question_bank_manager.html";
}
</script>
</body>
</html>
