<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Anjali â€“ Universal Exam Control Panel</title>

<style>
body{margin:0;font-family:system-ui;background:#f5f6fa}
header{background:#8b2d2d;color:#fff;padding:14px;text-align:center;font-size:20px}
#layout{display:flex;height:calc(100vh - 60px)}
#tree{width:340px;background:#fff;border-right:1px solid #ddd;overflow:auto;padding:10px}
#panel{flex:1;padding:10px;overflow:auto}

.subject{font-weight:bold;color:#8b2d2d;margin-top:8px;cursor:pointer}
.topic{margin-left:14px;padding:4px;border-radius:6px;cursor:pointer}
.topic:hover{background:#eee}
.topic.active{background:#8b2d2d;color:white}

button{padding:6px 12px;margin:4px;border:none;border-radius:6px;background:#8b2d2d;color:white;cursor:pointer}
.secondary{background:#555}
.danger{background:#b00020}

.box{border:1px dashed #aaa;padding:10px;margin-top:10px;border-radius:8px;background:#fff}
.big{min-height:260px;overflow:auto}
hr{border:none;border-top:1px dashed #ccc;margin:8px 0}
</style>
</head>

<body>
<header>ğŸ“š Anjali â€“ Universal Exam Control Panel</header>

<div id="layout">
<div id="tree"></div>

<div id="panel">
<h3 id="path">à¤•à¥‹à¤ˆ à¤µà¤¿à¤·à¤¯ à¤šà¥à¤¨à¥‡à¤‚</h3>

<!-- ARTICLE -->
<div class="box">
<b>ğŸ§  Article</b>
<textarea id="article" style="width:100%;min-height:140px"></textarea>
<button onclick="generateOneLiners()">ğŸ”¹ One-Liner à¤¬à¤¨à¤¾à¤</button>
<button class="secondary" onclick="saveOneLiners()">ğŸ’¾ Save</button>
<button onclick="generateFromArticle()">âš¡ Exam MCQ</button>
<div id="oneLinerView" class="big"></div>
</div>

<!-- QUIZ BANK -->
<div class="box">
<b>ğŸ“˜ Quiz Bank (MCQ)</b>
<button class="secondary" onclick="openQuestionBank()">ğŸ“š Question Bank</button>
<div id="quizView" class="big"></div>
</div>

<!-- ONE LINER BANK -->
<div class="box">
<b>ğŸ“Œ One-Liner / Notes</b>
<button class="secondary" onclick="openQuestionBank()">ğŸ“š Question Bank</button>
<div id="noteView" class="big"></div>
</div>

<!-- COMBINED -->
<div class="box">
<b>ğŸ“š Combined View</b>
<button class="secondary" onclick="openQuestionBank()">ğŸ“š Question Bank</button>
<div id="combinedView" class="big"></div>
</div>

</div>
</div>

<script>
/* ===== DATABASE ===== */
const AtoZ="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
const SYLLABUS={
"UP Police Constable":{
 "General Knowledge":{"A. History":[], "B. Geography":[], "C. Polity":[], "D. Economy":[], "E. Science":[], "F. Current Affairs":[]},
 "General Hindi":Object.fromEntries(AtoZ.map(x=>[x+". à¤µà¤¿à¤·à¤¯",[]])),
 "Numerical & Mental Ability":Object.fromEntries(AtoZ.map(x=>[x+". à¤µà¤¿à¤·à¤¯",[]])),
 "Mental Aptitude / Reasoning":Object.fromEntries(AtoZ.map(x=>[x+". à¤µà¤¿à¤·à¤¯",[]]))
}
};

let DB=JSON.parse(localStorage.getItem("anjaliDB"))||SYLLABUS;
function saveDB(){localStorage.setItem("anjaliDB",JSON.stringify(DB));}

/* ===== TREE ===== */
let currentExam=null,currentSubject=null,currentTopic=null;
const tree=document.getElementById("tree");

for(let exam in DB){
 let h=document.createElement("h3");h.textContent=exam;tree.appendChild(h);
 for(let subject in DB[exam]){
  let s=document.createElement("div");s.className="subject";s.textContent=subject;
  let list=document.createElement("div");
  for(let topic in DB[exam][subject]){
   let t=document.createElement("div");t.className="topic";t.textContent=topic;
   t.onclick=()=>{
    document.querySelectorAll(".topic").forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    currentExam=exam;currentSubject=subject;currentTopic=topic;
    path.textContent=exam+" â†’ "+subject+" â†’ "+topic;
    renderBanks();
   };
   list.appendChild(t);
  }
  s.onclick=()=>list.style.display=list.style.display=="block"?"none":"block";
  tree.appendChild(s);tree.appendChild(list);
 }
}

/* ===== RENDER ===== */
function renderBanks(){
 let arr=DB[currentExam][currentSubject][currentTopic]||[];

 quizView.innerHTML=arr.filter(x=>x.type==="mcq").map((q,i)=>`
 <div>
 <b>${q.q}</b>
 <button class="danger" onclick="deleteItem(${i})">ğŸ—‘ï¸</button><br>
 A) ${q.a} B) ${q.b}<br>
 C) ${q.c} D) ${q.d}<br>
 âœ” ${q.correct}<br><i>${q.exp}</i><hr>
 </div>
 `).join("") || "<i>à¤•à¥‹à¤ˆ MCQ à¤¨à¤¹à¥€à¤‚</i>";

 noteView.innerHTML=arr.filter(x=>x.type==="one-liner").map((o,i)=>`
 <div>${o.q}
 <button class="danger" onclick="deleteItem(${arr.indexOf(o)})">ğŸ—‘ï¸</button>
 <hr></div>
 `).join("") || "<i>à¤•à¥‹à¤ˆ One-Liner à¤¨à¤¹à¥€à¤‚</i>";

 combinedView.innerHTML=arr.map((x,i)=>`
 <div>
 <b>${x.q}</b>
 <button class="danger" onclick="deleteItem(${i})">ğŸ—‘ï¸</button><br>
 ${x.type==="mcq" ? `
 A) ${x.a} B) ${x.b}<br>
 C) ${x.c} D) ${x.d}<br>
 âœ” ${x.correct}<br><i>${x.exp}</i>` : `<i>One-Liner</i>`}
 <hr></div>
 `).join("") || "<i>à¤•à¥‹à¤ˆ à¤¡à¥‡à¤Ÿà¤¾ à¤¨à¤¹à¥€à¤‚</i>";
}

/* ===== DELETE ===== */
function deleteItem(i){
 DB[currentExam][currentSubject][currentTopic].splice(i,1);
 saveDB(); renderBanks();
}

/* ===== ONE LINER ===== */
let temp=[];
function generateOneLiners(){
 temp=[];
 article.value.split(/[à¥¤.\n]/).forEach(l=>{
  if(l.trim().length>25) temp.push(l.trim());
 });
 oneLinerView.innerHTML=temp.map(l=>`â€¢ ${l}<hr>`).join("");
}
function saveOneLiners(){
 temp.forEach(l=>{
  DB[currentExam][currentSubject][currentTopic].push({type:"one-liner",q:l});
 });
 temp=[]; saveDB(); renderBanks();
}

/* ===== ENGINE ===== */
function generateFromArticle(){
 const facts=extractExamFacts(article.value,currentSubject+"."+currentTopic);
 convertFactsToMCQ(facts).forEach(m=>{
  m.type="mcq";
  DB[currentExam][currentSubject][currentTopic].push(m);
 });
 saveDB(); renderBanks();
}

/* ===== NAV ===== */
function openQuestionBank(){
 window.location.href="question_bank_manager.html";
}
</script>

<script src="engine.js"></script>
</body>
</html>
