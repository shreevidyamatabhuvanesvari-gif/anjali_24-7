<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Anjali ‚Äì Question Bank Manager</title>
<style>
body{margin:0;font-family:system-ui;background:#f4f6fb}
header{background:#8b2d2d;color:#fff;padding:14px;text-align:center;font-size:20px}
#layout{display:flex;height:calc(100vh - 60px)}
#tree{width:340px;background:#fff;border-right:1px solid #ccc;padding:10px}
#panel{flex:1;padding:12px;overflow:auto}
.subject{font-weight:bold;color:#8b2d2d;margin-top:8px;cursor:pointer}
.topic{margin-left:14px;padding:4px;border-radius:6px;cursor:pointer}
.topic.active{background:#8b2d2d;color:#fff}
.box{border:1px solid #ccc;border-radius:8px;padding:10px;margin-bottom:12px;background:#fff}
hr{border:none;border-top:1px dashed #ccc}
</style>
</head>

<body>
<header>üìö Anjali ‚Äì Question Bank Manager</header>

<div id="layout">
<div id="tree"></div>
<div id="panel">
<h3 id="path">‡§ï‡•ã‡§à ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</h3>

<div class="box"><b>üìò Quiz Bank (MCQ)</b><div id="mcqView"></div></div>
<div class="box"><b>üìå One-Liner</b><div id="oneView"></div></div>
<div class="box"><b>üìö Combined</b><div id="allView"></div></div>
</div>
</div>

<script>
let DB=JSON.parse(localStorage.getItem("anjaliDB"))||{};
const tree=document.getElementById("tree");
let currentExam,currentSubject,currentTopic;

/* TREE */
for(let e in DB){
 let h=document.createElement("h3");h.textContent=e;tree.appendChild(h);
 for(let s in DB[e]){
  let sd=document.createElement("div");sd.className="subject";sd.textContent=s;
  let list=document.createElement("div");
  for(let t in DB[e][s]){
   let td=document.createElement("div");td.className="topic";td.textContent=t;
   td.onclick=()=>{currentExam=e;currentSubject=s;currentTopic=t;path.textContent=e+" ‚Üí "+s+" ‚Üí "+t;renderAll();};
   list.appendChild(td);
  }
  tree.appendChild(sd);tree.appendChild(list);
 }
}

function isValidMCQ(q){
 return q.type==="mcq"&&q.q&&q.a&&q.b&&q.c&&q.d&&["A","B","C","D"].includes(q.correct);
}

function renderAll(){
 let arr=DB[currentExam][currentSubject][currentTopic]||[];
 mcqView.innerHTML=arr.filter(isValidMCQ).map((q,i)=>`
 <b>${i+1}. ${q.q}</b><br>
 A) ${q.a}<br>B) ${q.b}<br>C) ${q.c}<br>D) ${q.d}<br>
 ‚úî ${q.correct}<br><i>${q.exp}</i><hr>`).join("")||"<i>‡§ï‡•ã‡§à ‡§µ‡•à‡§ß MCQ ‡§®‡§π‡•Ä‡§Ç</i>";

 oneView.innerHTML=arr.filter(x=>x.type==="one-liner").map((o,i)=>`${i+1}. ${o.q}<hr>`).join("")||"<i>‡§ï‡•ã‡§à One-Liner ‡§®‡§π‡•Ä‡§Ç</i>";

 allView.innerHTML=arr.map((x,i)=>isValidMCQ(x)?
 `<b>${i+1}. ${x.q}</b><br>A) ${x.a} B) ${x.b}<br>C) ${x.c} D) ${x.d}<br>‚úî ${x.correct}<hr>`:
 `${i+1}. ${x.q}<hr>`).join("")||"<i>‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç</i>";
}
</script>
</body>
</html>
