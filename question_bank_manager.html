<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Anjali ‚Äì Question Bank Manager</title>
<style>
body{margin:0;font-family:system-ui;background:#f4f6fb}
header{background:#8b2d2d;color:#fff;padding:14px;text-align:center;font-size:20px}
#layout{display:flex;flex-direction:column;height:calc(100vh - 60px)}
#tree{display:none}
#panel{flex:1;padding:12px;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center}

.big-box{
 width:90%;
 max-width:500px;
 height:70vh;
 background:#fff;
 border:2px solid #8b2d2d;
 border-radius:12px;
 padding:10px;
 overflow-y:auto;
 display:flex;
 flex-direction:column-reverse; /* ‡§®‡•Ä‡§ö‡•á ‡§∏‡•á ‡§ä‡§™‡§∞ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è */
 box-shadow:0 0 10px rgba(0,0,0,0.2);
}

.btn-group{
 display:flex;
 justify-content:space-around;
 margin-bottom:10px;
 width:100%;
}

button{
 flex:1;
 margin:4px;
 padding:10px;
 border:none;
 border-radius:6px;
 font-size:16px;
 background:#8b2d2d;
 color:#fff;
 cursor:pointer;
 transition:0.3s;
}
button:hover{opacity:0.8}

#anjaliBtn{
 background:#e91e63;
 font-weight:bold;
}

.question{border-bottom:1px dashed #ccc;padding:6px 0;}
</style>
</head>

<body>
<header>üìö Anjali ‚Äì Question Bank Manager</header>

<div id="layout">
 <div class="btn-group">
   <button onclick="showSection('mcq')">Quiz Bank (MCQ)</button>
   <button onclick="showSection('one')">One-Liner</button>
   <button onclick="showSection('all')">Combined</button>
 </div>

 <div class="big-box" id="displayBox">
   <div id="content">‡§ï‡•É‡§™‡§Ø‡§æ ‡§ä‡§™‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§à ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§</div>
 </div>

 <button id="anjaliBtn" onclick="toggleVoice()">üé§ ‡§Ö‡§Ç‡§ú‡§≤‡•Ä (‡§Ü‡§µ‡§æ‡§ú‡§º)</button>
</div>

<script>
let DB=JSON.parse(localStorage.getItem("anjaliDB"))||{};
let currentData = [];
let voiceActive = false;
let synth = window.speechSynthesis;

function showSection(type){
 let html="";
 if(!DB.example){
   html="<i>‡§°‡•á‡§Æ‡•ã ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§</i>";
 } else {
   let arr=DB.example.subject.topic || [];
   if(type==='mcq'){
     currentData = arr.filter(q=>q.type==='mcq');
     html=currentData.map((q,i)=>`
       <div class='question'><b>${i+1}. ${q.q}</b><br>
       A) ${q.a}<br>B) ${q.b}<br>C) ${q.c}<br>D) ${q.d}<br>
       ‚úî ${q.correct}</div>`).join("");
   } else if(type==='one'){
     currentData = arr.filter(q=>q.type==='one-liner');
     html=currentData.map((q,i)=>`<div class='question'>${i+1}. ${q.q}</div>`).join("");
   } else {
     currentData = arr;
     html=currentData.map((q,i)=>`<div class='question'>${i+1}. ${q.q}</div>`).join("");
   }
 }
 document.getElementById("content").innerHTML = html || "<i>‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç</i>";
 if(voiceActive){ readQuestions(); }
}

function toggleVoice(){
 voiceActive = !voiceActive;
 let btn = document.getElementById("anjaliBtn");
 if(voiceActive){
   btn.textContent="üîä ‡§Ö‡§Ç‡§ú‡§≤‡•Ä ‡§¨‡•ã‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à...";
   readQuestions();
 } else {
   btn.textContent="üé§ ‡§Ö‡§Ç‡§ú‡§≤‡•Ä (‡§Ü‡§µ‡§æ‡§ú‡§º)";
   synth.cancel();
 }
}

function readQuestions(){
 if(!currentData.length){ return; }
 synth.cancel();
 let voices = synth.getVoices();
 let femaleVoice = voices.find(v=>v.name.includes('Google ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‡§Æ‡§π‡§ø‡§≤‡§æ') || v.name.includes('Female')) || voices[0];
 currentData.forEach((q,i)=>{
   let utter = new SpeechSynthesisUtterance(q.q);
   utter.lang='hi-IN';
   utter.voice = femaleVoice;
   utter.rate = 1;
   synth.speak(utter);
 });
}
</script>
</body>
</html>
